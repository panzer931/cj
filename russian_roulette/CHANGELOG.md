# 麦麦轮盘插件改进日志

## 版本 1.2.0 - 重大功能更新

### 🎯 主要改进

#### 1. 双指令游戏系统
- **新增**: `麦麦轮盘` - 启动游戏指令
- **更新**: `麦麦开枪` - 参与游戏指令
- **改进**: 游戏流程更加清晰，用户体验更好

#### 2. 丰富的随机对话系统
- **新增**: 5种空子弹随机对话
  1. "嘿嘿，我要开枪咯，左轮手枪指着@用户，扣动扳机，咔咔，没有打中，你真好彩哎"
  2. "哦豁，又一个不怕死的，左轮手枪指着@用户，扣动扳机，咔咔，没有打中，嘿嘿，你有没有吓破胆"
  3. "我麦麦神枪手可从来没有失过手，左轮手枪指着@用户，猛烈扣下扳机，咔咔，没有打中，命真大啊"
  4. "想尿裤子就尽情的尿吧，左轮手枪猛的指着@用户，咔咔，没有打中"
  5. "我想吃牛肉面了，但你的牛肉面有葱花，左轮手枪迅速指着@用户的头，扣动扳机，咔咔，没有打中，哎呀其实有葱花的更香"

- **新增**: 特殊中弹对话
  - "我看你乌云盖顶呢，你确定要玩这游戏，左轮手枪迅速指着@用户扣动扳机，砰！鲜血染红了墙壁！"

- **新增**: 游戏启动对话
  - "哈哈，捡到一把俄罗斯左轮手枪啦，有没有胆肥的勇士，请说麦麦开枪来开始游戏，中枪的就要禁言哦"

#### 3. 移除用户参与限制
- **移除**: 同一用户重复参与检查
- **改进**: 用户可以在同一局游戏中多次开枪
- **增强**: 每次开枪都是独立的机会，增加游戏刺激性

#### 4. 改进的游戏状态管理
- **重构**: 游戏数据结构从"participants"改为"shots"记录
- **优化**: 更精确的游戏状态跟踪
- **增强**: 更好的超时处理机制

### 🔧 技术改进

#### 架构重构
- **新增**: `DialogueManager` 类管理所有对话模板
- **重构**: `RouletteStartCommand` 专门处理游戏启动
- **新增**: `RouletteShootCommand` 专门处理开枪逻辑
- **优化**: 代码结构更清晰，职责分离更明确

#### 配置系统增强
- **新增**: `dialogue` 配置节
- **扩展**: 支持自定义所有对话内容
- **改进**: 更灵活的配置选项

#### 错误处理优化
- **增强**: 更友好的错误提示
- **改进**: 更完善的异常处理
- **优化**: 更详细的日志记录

### 🎮 使用方法

#### 新的游戏流程
1. **启动游戏**: 在群聊中发送 `麦麦轮盘`
2. **参与游戏**: 发送 `麦麦开枪` 进行开枪
3. **重复参与**: 同一用户可以多次发送 `麦麦开枪`
4. **游戏结束**: 有人中弹或游戏超时

#### 配置选项
```toml
[dialogue]
start_message = "自定义启动消息"
empty_bullet_messages = ["自定义空子弹消息1", "消息2", ...]
hit_message = "自定义中弹消息"

[game_constants]
max_wait_time = 120  # 最大等待时间
min_mute_time = 60   # 最小禁言时间
max_mute_time = 3600 # 最大禁言时间
```

### 🐛 修复的问题
- 修复了语法错误导致的插件加载失败
- 修复了游戏状态管理的一些边界情况
- 优化了内存使用和性能表现

### 📈 性能优化
- 减少了不必要的数据存储
- 优化了游戏状态检查逻辑
- 改进了异步处理性能

### 🔄 兼容性
- 保持与现有配置文件的向后兼容
- 保持核心游戏机制不变
- 支持平滑升级

---

## 版本历史

### v1.2.0 (当前版本)
- 双指令游戏系统
- 丰富的随机对话
- 移除用户参与限制
- 架构重构和优化

### v1.1.0
- 适配最新 MaiBot 插件系统
- 基础功能实现

### v1.0.0
- 初始版本
- 基础俄罗斯轮盘功能